/*! For license information please see latest.js.LICENSE.txt */
(self.webpackChunkthe_grove=self.webpackChunkthe_grove||[]).push([[131],{989:(e,t,o)=>{(e.exports=o(252)()).push([e.id,"body,html{overflow:hidden;margin:0;width:100%;height:100%}.hotbar{border:1px solid #eee;margin-left:4px;margin-right:4px;text-align:center;line-height:50px;font-size:14px;color:#fff;padding:0}.hotbar.active{background:tomato}#blocker{font:100% Megrim,sans-serif;color:#fff;background-color:#000;z-index:5}#blocker,#underlay{position:absolute;width:100%;height:100%}#underlay{background-color:rgba(0,0,0,.8);z-index:1}#load{width:50%;height:50%;text-align:center}#load *{margin:0;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}#hud{position:fixed;left:5%;bottom:0;width:90%}#quest-alert{position:fixed;right:0;top:20%;width:280px;height:90px;padding-left:30px;padding-top:20px;background-image:url(/img/QuestBar.png);color:#fff}#quest-alert p{margin-bottom:-4px}#pause{width:60%;left:20%;font-family:Megrim,sans-serif}#gui,#pause{position:fixed;top:15%}#gui{z-index:4;width:70%;height:70%;left:15%;background-image:url(/img/gui.png);background-size:cover;padding-left:5%;padding-top:3%}#gui #gui-content{height:100%}#gui #gui-exit{position:fixed;bottom:22%;right:20%}#chat{position:fixed;bottom:0;left:0}#chat,#chat #chat-input{color:#fff}#crosshair{position:fixed;left:50%;top:50%}#offscreen-canvas{z-index:-30000}",""])},138:(e,t,o)=>{(e.exports=o(252)()).push([e.id,'*{margin:0;padding:0}.clear{clear:both}body{background:#444;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAACcklEQVR4nO3bSVJcQQwE0L4MBsLYpid6ZLBphvtfCHYO6i1+Rq+0QAstMvSrSyiUGqqK2fvb8eNuff1f5rcXA16vrge8ufs54Od/m8nv314PA364Xwx4v/s9qff3kv70vJ3UPz4sBzz7Cr6jtAOqDaiWmRw1B6h/fdkP+Hi4HbAc3W1/nbVeDv99Wg/4/jif3M8cZQ4w53QEVBtQLe0AOSTnD/s/A14uLge8Wl4NWI6/nHYDdj/rshw2J6WcoT2L+Y8B27d0BFQbUC3tAOusnJVzcky9dVbOyfHEefXu5/fONuYwc1RHQLUB1dIOsFeWY2meNifI2e3mZsBy1hzk9+YQ67rrU87Q3o6AagOqpR2QeunE6dTbi+0z3M+6nfoC677Yv8/f6wioNqBa2gFyTpx698Q5zxes49Zp676cfXpcTf6+Z4aeSdrXdARUG1At7QDrejofkIP2AXI29QWuT/O7nNYec0jqKzoCqg2olnZAuu+Xs9b9lEPkoHVfTnvv4P7WffsOsX+POacjoNqAamkHyFE5J8ety+e+6Uk5JK237pszXO95g/t3BFQbUC3tgHRmpj698UlnfPYJcjzd52uf+6l3lul3gkZAtQHV0g5I9/dyyvt/9alup9nBXt/90jtAOa6+zwOMgGoDqqUdICc8V7fX9vt0V+h6OW2f4PnAue8VEu63wkZAtQHV0g6wrlqXnZ/tvZ0VEudcb6+eZhFzguudJZxdzEkdAdUGVEs7QI7IUbGcTrOBfYWzh5yWw+l/ftLbZPXmjI6AagOqpR1gL+78bo5wXk93femNz7nzvvaI7WPMKeKOgGoDquXbO+ATIF9D9wrQ0EMAAAAASUVORK5CYII=")}.wrap{width:320px;margin:auto}.skillpoints_content{background-color:#444;color:#fff;margin:10px;padding:10px}#skillpoints{color:#fff}.mainSkillTreeContener{display:block;margin:auto}.skill_group{float:left;width:350px}.skill{position:relative;text-align:center;user-select:none;cursor:default;margin:6px;display:inline-block;width:80px;height:80px;border-radius:5px;box-shadow:0 3px 6px 3px;background-image:url("/img/icons.jpg");background-size:1000% auto}.skill.sm .abbr{font-size:28px}.skill.sm2 .abbr{font-size:20px}.skill.sm3 .abbr{font-size:14px}.skill .abbr{display:none;width:100%;height:100%;text-shadow:0 1px hsla(0,0%,100%,.8),0 -1px #000;overflow:hidden;font:700 48px Arial,Helvetica,sans-serif;text-align:center;line-height:80px;background:#888;color:#444}.skill.nosprite .abbr{display:block}.skill .status{font:700 8px Arial,Helvetica,sans-serif;display:block;position:absolute;color:#fff;bottom:3px;right:3px;background:rgba(0,0,0,.5);padding:.75px 1.5px;border-radius:3px;z-index:2;user-select:none}.skill div{display:none}.skill:after{background:rgba(0,0,0,.5);display:block;content:"";top:-3px;bottom:-3px;left:-3px;right:-3px;position:absolute;border-radius:5px;border:3px solid #888;box-shadow:inset 0 0 0 1px #fff,0 0 0 1px #fff,inset 0 0 12px rgba(0,0,0,.5),inset 0 0 3px,0 0 3px}.skill.available{cursor:pointer}.skill.available:after{border-color:#cc5;box-shadow:inset 0 0 0 1px #fff,0 0 0 1px #fff,inset 0 0 9px 0 #000,0 0 15px -3px #ff5,inset 0 0 3px 1.5px hsla(0,0%,100%,.5),inset 0 0 12px rgba(0,0,0,.5),inset 0 0 3px,0 0 3px}.skill.active:after{background:none}.skillHint{font:normal 12px Arial,Helvetica,sans-serif;pointer-events:none;position:absolute;z-index:30;border-radius:3px;padding:6px 12px 24px;background:rgba(0,0,0,.9);max-width:400px;color:#ccc;text-shadow:0 1px 1px #000;box-shadow:0 0 0 1px #000,0 0 0 2px hsla(0,0%,100%,.2)}.skillHint,.skillHint .alias{display:none}.skillHint h1,.skillHint h3,.skillHint h4{color:#fc0;margin-bottom:3px}.skillHint p,.skillHint ul{margin-bottom:9px}.skillHint p+h1,.skillHint p+h2,.skillHint p+h3,.skillHint p+h4,.skillHint ul+h1,.skillHint ul+h2,.skillHint ul+h3,.skillHint ul+h4{margin-top:9px}.skillHint i{color:#0a0}.skillHint b{color:#88f;font-weight:400}.skillHint li{list-style-type:none}.skillHint .commamenu li{float:left;list-style-type:none}.skillHint .commamenu li:before{content:""}.skillHint .commamenu li+li:before{content:", "}.skillHint .commamenu:after{clear:both;display:block;content:""}.skillHint .reqs{color:#a00}.skillHint .met{color:#0a0}',""])},850:(e,t,o)=>{var n=o(989);"string"==typeof n&&(n=[[e.id,n,""]]),o(246)(n,{}),n.locals&&(e.exports=n.locals)},259:(e,t,o)=>{var n=o(138);"string"==typeof n&&(n=[[e.id,n,""]]),o(246)(n,{}),n.locals&&(e.exports=n.locals)},677:(e,t,o)=>{"use strict";o(850),o(259);var n=o(687);let i={world:new n.q3,socket:io(),remove:{bodies:[],meshes:[]},controls:{enabled:!1,update(e){}},delta:Date.now(),groundMaterial:new n.F5("groundMaterial")},a=new n.kp(i.groundMaterial,i.groundMaterial,{friction:50,restitution:.3});i.world.addContactMaterial(a);const s=i;var r=o(640);const l=JSON.parse('{"@item":{"name":"-- Item --","desc":"If you see this, please contact developers","weight":0,"ench":{}},"@weapon":{"proto":"@item","name":"-- Weapon --","dmg":0,"spd":0,"knbk":0,"slot":0,"cost":{}},"@sword":{"proto":"@weapon","name":"-- Sword --","blade":{},"handle":{}},"@blade":{"proto":"@weapon","name":"-- Blade --","mat":{}},"@handle":{"proto":"@weapon","name":"-- Handle --","mat":{}},"@bow":{"proto":"@weapon","name":"-- Bow --","body":{},"string":{}},"@body":{"proto":"@weapon","name":"-- Bow Body --","mat":{}},"@string":{"proto":"@weapon","name":"-- Bowstring --","mat":{}},"@spell":{"proto":"@weapon","name":"-- Spell --","weight":0},"@material":{"proto":"@item","dur":0,"spd":0,"dmg":0}}'),d=JSON.parse('{"shortsword":{"proto":"@sword","name":"Shortsword","desc":"A shortened sword","slot":1},"longsword":{"proto":"@sword","name":"Longsword","desc":"Slonglord!  Wait a sec...","slot":2}}'),c=JSON.parse('{"wood":{"proto":"@material","name":"Wood","desc":"A block of wood.  Interesting.","weight":2,"dmg":3,"dur":1,"spd":4},"iron":{"proto":"@material","name":"Iron","desc":"A bar of iron for all of your irony needs","weight":5,"dmg":7,"dur":3,"spd":3},"steel":{"proto":"@material","name":"Steel","desc":"A rod of steel, a steel rod","weight":6,"dmg":12,"dur":5,"spd":3},"ebony":{"proto":"@material","name":"Ebony","desc":"Like ebay, but ebony","weight":10,"dmg":16,"dur":8,"spd":2},"ivory":{"proto":"@material","name":"Ivory","desc":"A fine, delicate material","weight":0.5,"dmg":2,"dur":1,"spd":15},"dragonivory":{"proto":"ivory","name":"Dragon Ivory","desc":"Carved from the scales of the finest dragons in The Grove","dmg":4,"dur":2}}');Object.assign(l,d,c);let p=new r(l);function h(e,t){let o=p.get(e),n=p.get(t);return o.mat=n,o.dmg=n.dmg,o.spd=n.spd,o.dur=n.dur,o.name="test",JSON.parse(JSON.stringify(o))}function m(e,t,o){let n=p.get(e?"longsword":"shortsword"),i=h("@blade",t),a=h("@handle",o);n.blade=i,n.handle=a,n.name=`${n.blade.mat.name} ${n.name}`,n.dmg=(i.dmg+a.dmg)/2,n.spd=(i.spd+a.spd)/2,n.slot="weapon",n.icon="two-handed-sword.svg",n.id=Math.random();let s=JSON.parse(JSON.stringify(n));return n=null,s.id=Math.random(),s}const u=new class{constructor(){var e;this.hp={val:10,max:10},this.mp={val:5,max:5},this.xp={level:0,xp:3,max:10},this.equipped={weapon:null},this.inventory=[],this.hotbar={list:[],selected:1,active:null},e=(e,t)=>{this.inventory.push(t(0,"iron","wood")),this.inventory.push(t(0,"ebony","iron"))},p=new r(l),e(0,m)}};var g=o(212);let w=[];const f=(e,t,o,n=!1)=>w.push({body:e,shape:t,mesh:o,norotate:n})-1,b=e=>w[e],y=new Worker(new URL(o.p+o.u(894),o.b));let k=new SharedArrayBuffer(40960),x=new Float32Array(k),v=new g.cPb,E=[],A=0;const M=e=>{e.updateMatrixWorld();let t=new g.Pa4,o=new g._fP,n=new g.Pa4;e.matrixWorld.decompose(t,o,n);const i=10*e.entityId;x[i+0]=t.x,x[i+1]=t.y,x[i+2]=t.z,x[i+3]=o.x,x[i+4]=o.y,x[i+5]=o.z,x[i+6]=o.w,x[i+7]=n.x,x[i+8]=n.y,x[i+9]=n.z},z=()=>{for(let e of E)M(e)},H=e=>{E[A]=e,e.entityId=A++;const t=(new g.u9r).fromGeometry(e.geometry),o=[];for(let e of Object.keys(t.attributes))o.push(t.attributes[e].array.buffer);const{map:n}=e.material;n&&L(n),y.postMessage({type:"addObject",name:e.name,geometry:t,imageName:null==n?void 0:n.name},o)},L=e=>{let t=document.createElement("canvas");t.width=e.image.width,t.height=e.image.height;let o=t.getContext("2d");o.drawImage(e.image,0,0);let n=o.getImageData(0,0,e.image.width,e.image.height);y.postMessage({type:"uploadTexture",imageName:e.name,imageData:n.data,imageWidth:e.image.width,imageHeight:e.image.height})};let P={},O={},q={};var W,D,I,B,C,S,Q,T,j,U=function(e,t,o){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,o),o},N=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};class X{constructor(e,t,o){this.isLocked=!1,W.set(this,0),D.set(this,Math.PI),I.set(this,1),B.set(this,10),C.set(this,!1),S.set(this,!1),Q.set(this,!1),T.set(this,!1),j.set(this,!1),this.camera=e,this.domElement=t,this.body=o,this.body.allowSleep=!1,this.body.linearDamping=.9,o.addEventListener("collide",(e=>{let t=e.contact,i=new n.AO;t.bi.id==o.id?t.ni.negate(i):i.copy(t.ni),i.dot(new n.AO(0,1,0))>.64&&U(this,j,!0)})),this.connect()}onPointerlockChange(){this.isLocked=this.domElement.ownerDocument.pointerLockElement===this.domElement}onPointerlockError(){}onMouseMove(e){if(!this.isLocked)return;let{movementX:t,movementY:o}=e,n=new g.USm(0,0,0,"YXZ");n.setFromQuaternion(this.camera.quaternion),n.y-=.002*t,n.x-=.002*o;const i=Math.PI/2;n.x=Math.max(i-N(this,D),Math.min(i-N(this,W),n.x)),this.camera.quaternion.setFromEuler(n)}onKeyDown(e){switch(e.keyCode){case 38:case 87:U(this,C,!0);break;case 37:case 65:U(this,Q,!0);break;case 40:case 83:U(this,S,!0);break;case 39:case 68:U(this,T,!0);break;case 32:N(this,j)&&(this.body.velocity.y=N(this,B)),U(this,j,!1)}}onKeyUp(e){switch(e.keyCode){case 38:case 87:U(this,C,!1);break;case 37:case 65:U(this,Q,!1);break;case 40:case 83:U(this,S,!1);break;case 39:case 68:U(this,T,!1)}}connect(){this.domElement.ownerDocument.addEventListener("mousemove",(e=>this.onMouseMove(e))),this.domElement.ownerDocument.addEventListener("keydown",(e=>this.onKeyDown(e))),this.domElement.ownerDocument.addEventListener("keyup",(e=>this.onKeyUp(e))),this.domElement.ownerDocument.addEventListener("pointerlockchange",(()=>this.onPointerlockChange()))}disconnect(){this.domElement.ownerDocument.removeEventListener("mousemove",this.onMouseMove),this.domElement.ownerDocument.removeEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.removeEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError)}dispose(){this.disconnect()}update(e){e*=.1;let t=new g.Pa4(0,0,0);N(this,C)&&(t.z=-N(this,I)*e),N(this,S)&&(t.z=N(this,I)*e),N(this,Q)&&(t.x=-N(this,I)*e),N(this,T)&&(t.x=N(this,I)*e),N(this,j)&&(t.x*=.8,t.y*=.8,t.z*=.8),t.applyQuaternion(this.camera.quaternion),this.body.velocity.x+=t.x,this.body.velocity.z+=t.z;const{x:o,y:n,z:i}=this.body.position;this.camera.position.copy(new g.Pa4(o,n,i))}getDirection(){let e=new g.Pa4(0,0,-1);return t=>t.copy(e).applyQuaternion(this.camera.quaternion)}lock(){this.domElement.requestPointerLock()}unlock(){this.domElement.ownerDocument.exitPointerLock()}}W=new WeakMap,D=new WeakMap,I=new WeakMap,B=new WeakMap,C=new WeakMap,S=new WeakMap,Q=new WeakMap,T=new WeakMap,j=new WeakMap;let K=!1;var Y,V,J,R;(()=>{const e=document.getElementById("main-canvas").transferControlToOffscreen();E[A]=v,v.entityId=A++,z(),y.postMessage({type:"init",buffer:k,canvas:e,width:window.innerWidth,height:window.innerHeight,pixelRatio:window.devicePixelRatio},[e])})(),(e=>{$(document).on("mousedown",(()=>{if(!e.controls.enabled)return;let t=((e={},t)=>{var o,i,a,s;let r=new n.aL(null!==(o=e.radius)&&void 0!==o?o:.2),l=new n.uT({mass:null!==(i=e.mass)&&void 0!==i?i:10});l.addShape(r),t.world.addBody(l);let d=new g.xo$(r.radius,32,32),c=e.mesh||new g.Kj0(d,e.mat||new g.xoR({color:null!==(a=e.c)&&void 0!==a?a:52479}));H(c);const p=f(l,r,c,null==e?void 0:e.norotate);let h=b(p);return null===(s=e.cb)||void 0===s||s.call(e,h),h})({c:16729344},e),o=new g.Pa4;(e=>{let t=b(0),o=e;e.set(0,0,1),o.unproject(v);let n=new g.zHn(t.body.position,o.sub(t.body.position).normalize());e.copy(n.direction)})(o);const{x:i,y:a,z:s}=o;t.body.velocity.set(20*i,20*a,20*s);let r=b(0),{x:l,y:d,z:c}=r.body.position;l+=o.x*(1.02*r.shape.radius+t.shape.radius),d+=o.y*(1.02*r.shape.radius+t.shape.radius),c+=o.z*(1.02*r.shape.radius+t.shape.radius),t.body.position.set(l,d,c),t.mesh.position.set(l,d,c),t.body.addEventListener("collide",(()=>{setTimeout((()=>{e.remove.bodies.push(t.body)}),1500)}))}))})(s),((e,t)=>{(e=>{e.allowSleep=!0,e.defaultContactMaterial.contactEquationStiffness=1e9,e.defaultContactMaterial.contactEquationRelaxation=4,e.defaultContactMaterial.friction=2;let t=new n.wf;t.iterations=7,t.tolerance=.1,e.solver=new n.H5(t),e.gravity.set(0,-9.8,0),e.broadphase=new n.KK})(e.world),((e,t)=>{let o=new n.aL(1.7),i=new n.uT({mass:100,material:e.groundMaterial});i.addShape(o),i.position.set(0,30,0),i.angularDamping=.9,e.world.addBody(i),i.addEventListener("collide",(e=>{const o=e.contact,a=new n.AO(0,1,0);let s=new n.AO;o.bi.id==i.id?o.ni.negate(s):s.copy(o.ni),s.dot(a)>.5&&i.velocity.y<=-60&&(t.hp.val-=Math.floor(Math.abs(i.velocity.y)/10))})),f(i,o,new g.Tme,!0),e.controls=new X(v,document.body,i)})(e,t)})(s,u),V=e=>((e,t,o)=>{let i=[],a=[];const{geometry:s}=e;for(let e=0;e<s.vertices.length;e++){const{x:t,y:o,z:n}=s.vertices[e];i.push(t),i.push(o),i.push(n)}for(let e=0;e<s.faces.length;e++){const{a:t,b:o,c:n}=s.faces[e];a.push(t),a.push(o),a.push(n)}let r=new n.np(i,a),l=new n.uT({mass:0,material:o.groundMaterial});l.addShape(r);const{x:d,y:c,z:p}=e.position,{x:h,y:m,z:u,w:g}=e.quaternion;l.position.copy(new n.AO(d,c,p)),l.quaternion.copy(new n._f(h,m,u,g)),o.world.addBody(l);const w=f(l,r,e);return b(w)})(e,0,s),O[Y="/models/skjar-isles/skjar-isles.json"]=null!==(J=O[Y])&&void 0!==J?J:0,++O[Y],q[Y]=null!==(R=q[Y])&&void 0!==R?R:[],q[Y].push(V),1===O[Y]&&(new g.Gql).load(Y,(e=>{P[Y]=e,P[Y].updateMatrixWorld(),P[Y].traverse((e=>{if(e instanceof g.Kj0)for(let t of q[Y]){let o=e.clone();e.updateMatrixWorld();let n=new g.Pa4,i=new g._fP,a=new g.Pa4;e.matrixWorld.decompose(n,i,a),o.position.copy(n),o.quaternion.copy(i),o.scale.copy(a),H(o),t(o)}}))})),P[Y]&&P[Y].traverse((e=>{let t=e.clone();e.updateMatrixWorld();let o=new g.Pa4,n=new g._fP,i=new g.Pa4;e.matrixWorld.decompose(o,n,i),t.position.copy(o),t.quaternion.copy(n),t.scale.copy(i),H(t),V(t)})),(e=>{let t=document.getElementById("blocker"),o=document.getElementById("hud");if("pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document){let n=document.body;const i=()=>{document.pointerLockElement===n?(e.controls.enabled=!0,t.style.display="none",$("#pause").hide(),o.style.display=""):(e.controls.enabled=!1,o.style.display="none",$("#pause").show())},a=()=>{};document.addEventListener("pointerlockchange",i,!1),document.addEventListener("mozpointerlockchange",i,!1),document.addEventListener("webkitpointerlockchange",i,!1),document.addEventListener("pointerlockerror",a,!1),document.addEventListener("mozpointerlockerror",a,!1),document.addEventListener("webkitpointerlockerror",a,!1);const s=()=>{document.body.requestFullscreen(),n.requestPointerLock()};document.getElementsByClassName("play-btn")[0].onclick=s}else alert("Your browser doesn't support the HTML5 PointerLock API!")})(s),console.groupCollapsed("[LoadingManager]"),g.tEQ.onProgress=(e,t,o)=>{console.log(`${e} (${t}/${o})`),t==o&&(console.groupEnd(),$("#spinner").hide(),$("#load-play-btn, .play-btn").show(),K=!0)};const Z=()=>{if(K&&s.controls.enabled){for(let e in s.remove.bodies)s.world.removeBody(s.remove.bodies[e]),delete s.remove.bodies[e];for(let e in s.remove.meshes)delete s.remove.meshes[e];s.world.step(1/60,Date.now()-s.delta);for(let e of w)e.mesh.position.copy(e.body.position),e.norotate||e.mesh.quaternion.copy(e.body.quaternion);if($("#health-bar").val(Math.abs(u.hp.val/u.hp.max*100)),$("#health").text(`${Math.abs(u.hp.val)} HP`),u.hp.val<=0)return s.socket.disconnect(),$("#blocker").fadeIn(5e3),void $("#load").show().html("<h1>You Have Perished. Game Over...</h1>");s.controls.update(Date.now()-s.delta),z(),s.delta=Date.now()}requestAnimationFrame(Z)};Z(),window.addEventListener("resize",(()=>{}))}},e=>{"use strict";e.O(0,[736],(()=>(677,e(e.s=677)))),e.O()}]);